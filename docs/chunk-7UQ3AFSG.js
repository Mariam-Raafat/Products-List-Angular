import{E as y,F as u,a as i,b as a,c as S,e as j,h as k,j as v,k as w}from"./chunk-A4JCSWB7.js";function L(n){let t=y(()=>n());return E(t)?new Proxy(n,{get(e,o){return o in t?(v(e[o])||Object.defineProperty(e,o,{value:u(()=>e()[o]),configurable:!0}),L(e[o])):e[o]}}):n}var q=[WeakSet,WeakMap,Promise,Date,Error,RegExp,ArrayBuffer,DataView,Function];function E(n){if(n===null||typeof n!="object"||W(n))return!1;let t=Object.getPrototypeOf(n);if(t===Object.prototype)return!0;for(;t&&t!==Object.prototype;){if(q.includes(t.constructor))return!1;t=Object.getPrototypeOf(t)}return t===Object.prototype}function W(n){return typeof n?.[Symbol.iterator]=="function"}var F=new WeakMap,s=Symbol("STATE_SOURCE");function f(n,...t){n[s].update(e=>t.reduce((o,r)=>i(i({},o),typeof r=="function"?r(o):r),e)),A(n)}function K(n){return n[s]()}function O(n){return F.get(n[s])||[]}function A(n){let t=O(n);for(let e of t){let o=y(()=>K(n));e(o)}}function I(...n){let t=[...n],e=typeof t[0]=="function"?{}:t.shift(),o=t;return(()=>{class c{constructor(){let d=o.reduce((l,T)=>T(l),H()),{stateSignals:p,props:P,methods:R,hooks:x}=d,m=i(i(i({},p),P),R);this[s]=d[s];for(let l of Reflect.ownKeys(m))this[l]=m[l];let{onInit:g,onDestroy:b}=x;g&&g(),b&&j(k).onDestroy(b)}static \u0275fac=function(p){return new(p||c)};static \u0275prov=S({token:c,factory:c.\u0275fac,providedIn:e.providedIn||null})}return c})()}function H(){return{[s]:w({}),stateSignals:{},props:{},methods:{},hooks:{}}}function B(n){return t=>{let e=n(i(i(i({[s]:t[s]},t.stateSignals),t.props),t.methods));return Reflect.ownKeys(e),a(i({},t),{props:i(i({},t.props),e)})}}function M(n){return B(n)}function D(n){return t=>{let e=n(i(i(i({[s]:t[s]},t.stateSignals),t.props),t.methods));return Reflect.ownKeys(e),a(i({},t),{methods:i(i({},t.methods),e)})}}function C(n){return t=>{let e=typeof n=="function"?n():n,o=Reflect.ownKeys(e);t[s].update(c=>i(i({},c),e));let r=o.reduce((c,h)=>{let d=u(()=>t[s]()[h]);return a(i({},c),{[h]:L(d)})},{});return a(i({},t),{stateSignals:i(i({},t.stateSignals),r)})}}var U=0,Q=1,tt=I({providedIn:"root"},C({counter:U,favList:[],basketList:[],productCount:Q}),M(n=>({count:u(()=>n.favList().length),basketCount:u(()=>n.basketList().length),totalPrice:u(()=>{let t=n.basketList(),e=0;for(let o of t){let r=o.quantity||1;e+=o.price*r}return e})})),D(n=>({addToFavList:t=>f(n,{favList:n.favList().some(e=>e.id===t.id)?n.favList():[...n.favList(),t]}),removeFromFavList:t=>f(n,{favList:n.favList().filter(e=>e.id!==t)}),addToBasketList:t=>f(n,{basketList:n.basketList().some(e=>e.id===t.id)?n.basketList():[...n.basketList(),t]}),removeFromBasket:t=>f(n,{basketList:n.basketList().filter(e=>e.id!==t)}),increaseQuantity:t=>{let e=n.basketList().map(o=>{let r=o.quantity||n.productCount();return o.id===t&&r<o.stock?a(i({},o),{quantity:r+n.productCount()}):o});f(n,{basketList:e})},decreaseQuantity:t=>{let e=n.basketList().map(o=>{let r=o.quantity||1;return o.id===t&&r>1?a(i({},o),{quantity:r-1}):o});f(n,{basketList:e})}})));export{tt as a};
